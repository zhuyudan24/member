webpackJsonp([28],{DwIv:function(e,t){},WQrv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),r=a.n(s),o=a("WSiR"),n=a("AKaA"),i=a("NTL1"),l=a("8V46"),c=a("SJI6"),m={name:"membergrop-detail",data:function(){return{bodyHeight:document.body.clientHeight||document.documentElement.clientHeight,memberGroupId:this.$route.query.memberGroupId||"",navpath:[{name:"首页",path:""},{name:"会员分组",path:"/membergroup"},{name:"会员分组详情",path:""}],groupForm:{memberGroupName:"",memberGroupDescribe:"",memberSearchStr:""},page:{currentPage:1,pageSize:20,totalPage:0,total:""},memberData:[],sortColName:"",sortType:"desc",singleInfo:{sex:0,age:0,cardNo:0,mainStoreName:"dd",costFee:0,costTimes:0,lastCost:0,numOfSale:0,numOfmarket:0,couponCount:0,status:0,wxStatus:0,phoneStatus:0,authStatus:0}}},computed:r()({},Object(c.mapState)(["storeImageUrl"])),filters:{formatMember:function(e){return e&&e.length>3&&(e=e.substr(0,3)+"..."),e},formatTimeYMD:function(e){return"--"!=e?e.split(" ")[0]:"--"},formatTimeHMS:function(e){return"--"!=e?e.split(" ")[1]:"--"}},methods:{showSingleInfo:function(e){var t=this;this.singleInfo="",Object(n.a)(i.a.singleInfo,{memberId:e}).then(function(e){if(0===e.data.errorCode){var a=e.data.result.memberSingle;t.singleInfo=r()({},a,{sex:0==a.sex?"性别未知":1==a.sex?"男":"女",age:0!=a.age?a.age:"年龄未知",cardNo:a.cardNo?a.cardNo:"无会员卡",mainStoreName:a.mainStoreName?a.mainStoreName:"主门店未知"})}else Object(l.a)(e.data.message)}).catch(function(e){Object(l.b)(e)})},linkDetail:function(e){this.$router.push({path:"/wechatmemberDetail",query:{memberId:e}})},handleCurrentChange:function(e){this.page.currentPage=e,this.getAjaxMembers({pageSize:20,currentPage:e})},handleSizeChange:function(e){this.page.pageSize=e,this.getAjaxMembers({pageSize:e,currentPage:1})},sortChange:function(e){this.sortColumn=e.prop,"descending"===e.order?this.getAjaxMembers({sortColName:this.sortColumn,sortType:"desc"}):"ascending"===e.order&&this.getAjaxMembers({sortColName:this.sortColumn,sortType:"asc"})},getAjaxMembers:function(e){var t=this;Object(n.a)(i.a.ajaxMembers,{sortColName:e.sortColName||this.sortColName,sortType:e.sortType||this.sortType,memberSearchStr:this.groupForm.memberSearchStr,pageName:"wxMember",showFields:"name,status,grade,costAll,costTimes,lastCostTime,createTime",pageSize:e.pageSize||20,currentPage:e.currentPage||1}).then(function(e){0===e.data.errorCode?(t.memberData=e.data.result.page.result.map(function(e){return r()({},e,{sex:0==e.sex?"未知":"1"==e.sex?"男":"女",costFee:null==e.costFee?"--":"￥"+parseInt(e.costFee,10).toFixed(2),createTime:"-1"!=e.createTime?t.formatLongTime(""+e.createTime):"--",lastCostTime:e.lastCostTime&&"-1"!=e.lastCostTime?t.formatLongTime(""+e.lastCostTime):"--",thirdImgUrl:e.thirdImgUrl?e.thirdImgUrl:t.storeImageUrl})}),t.page.currentPage=e.data.result.page.currentPage,t.page.total=e.data.result.page.totalCount,t.page.totalPage=e.data.result.page.totalPage):Object(l.a)(e.data.message)}).catch(function(e){Object(l.b)(e)})},getDetail:function(){var e=this;Object(n.a)(i.a.findMemberGroupInfo,{memberGroupId:this.memberGroupId}).then(function(t){if(0!==t.data.errorCode)return Object(l.a)(t.data.message),!1;e.groupForm.memberGroupName=t.data.result.memberGroup.memberGroupName,e.groupForm.memberGroupDescribe=t.data.result.memberGroup.memberGroupDescribe,e.groupForm.memberSearchStr=t.data.result.memberGroup.memberSearchStr,e.getAjaxMembers({})}).catch(function(e){Object(l.b)(e)})},formatLongTime:function(e){return e.substr(0,4)+"-"+e.substr(4,2)+"-"+e.substr(6,2)+" "+e.substr(8,2)+":"+e.substr(10,2)+":"+e.substr(12,2)},goback:function(){this.$router.push({path:"/membergroup"})}},created:function(){this.memberGroupId&&this.getDetail(),this.storeImageUrl||this.$store.dispatch("getStorePicture"),this.$store.commit("mutations-slide",!1)},components:{"v-nav":o.a}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"member-group-detail",style:{height:e.bodyHeight-64+"px"}},[a("v-nav",{attrs:{navpath:e.navpath}}),e._v(" "),a("div",{staticClass:"wrap"},[a("div",{staticClass:"groupmember"},[a("p",{staticClass:"groupmember-title"},[e._v("会员共"+e._s(e.page.total)+"人")]),e._v(" "),a("div",{staticClass:"table-content"},[a("el-table",{ref:"multipleTable",attrs:{data:e.memberData,"tooltip-effect":"dark"},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{prop:"title",label:"会员信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"tablecontent-cell",staticStyle:{cursor:"pointer"},on:{click:function(a){return e.linkDetail(t.row.memberId)}}},[a("el-popover",{attrs:{placement:"top-start",width:"400",height:"180",trigger:"hover"},on:{show:function(a){return e.showSingleInfo(t.row.memberId)}}},[a("div",{staticClass:"pointer",on:{click:function(a){return e.linkDetail(t.row.memberId)}}},[a("div",{staticClass:"singelinfo"},[a("div",{staticClass:"singelinfo-img"},[a("img",{attrs:{width:"100",height:"100",src:t.row.thirdImgUrl?t.row.thirdImgUrl:"./static/img/default.png",alt:""}})]),e._v(" "),a("div",{staticClass:"singelinfo-content pLeft10 pRight10"},[a("span",{staticClass:"lheigth0"},[e._v(e._s(t.row.memberName)+"\n                          "),a("span",{staticClass:"channelicon fr",class:0==e.singleInfo.status?"gzhiconcanclegray":1==e.singleInfo.status?"gzhicon":"gzhicongray",attrs:{title:0==e.singleInfo.status?"取消关注公众号":1==e.singleInfo.status?"已关注公众号":"未关注公众号"}}),e._v(" "),a("span",{staticClass:"channelicon fr mr6",class:0==e.singleInfo.wxStatus?"xcxicongray":1==e.singleInfo.wxStatus?"xcxicon":"",attrs:{title:0==e.singleInfo.wxStatus?"未使用小程序":1==e.singleInfo.wxStatus?"使用过小程序":""}})]),e._v(" "),a("p",{staticClass:"lheigth0"},[a("span",{staticClass:"evl-right"},[e._v(e._s(e.singleInfo.sex))]),a("span",{staticClass:"evl-right"},[e._v(e._s(e.singleInfo.age))]),a("span",{attrs:{title:e.singleInfo.cardNo}},[e._v(e._s(e.singleInfo.cardNo))])]),e._v(" "),a("p",{staticClass:"lheigth0"},[a("span",{staticClass:"fix-block"},[e._v(e._s(e.singleInfo.mainStoreName))])]),e._v(" "),a("div",{staticClass:"singelinfo-cost"},[a("div",{staticClass:"singelinfo-costitem"},[a("p",[e._v(e._s(e.singleInfo.costFee))]),e._v(" "),a("p",[e._v("消费总额")])]),e._v(" "),a("div",{staticClass:"singelinfo-costitem"},[a("p",[e._v(e._s(e.singleInfo.costTimes))]),e._v(" "),a("p",[e._v("消费次数")])]),e._v(" "),a("div",{staticClass:"singelinfo-costitem"},[a("p",[e._v(e._s(e.singleInfo.lastCost))]),e._v(" "),a("p",[e._v("最近消费")])])])])]),e._v(" "),a("div",{staticClass:"singelinfo-jl mBottom20 mTop20"},[a("a",{staticClass:"singelinfo-jlitem"},[e._v("消费记录 ("+e._s(e.singleInfo.numOfSale)+")")]),e._v(" "),a("a",{staticClass:"singelinfo-jlitem"},[e._v("营销记录 ("+e._s(e.singleInfo.numOfmarket)+")")]),e._v(" "),a("a",{staticClass:"singelinfo-jlitem"},[e._v("卡券记录 ("+e._s(e.singleInfo.couponCount)+")")])])]),e._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[a("img",{staticClass:"tablecontent-cellimg mr6",attrs:{width:"60",height:"60",src:t.row.thirdImgUrl?t.row.thirdImgUrl:"./static/img/default.png",alt:""}})])]),e._v(" "),a("span",[e._v(e._s(e._f("formatMember")(t.row.memberName)))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"会员状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticClass:"channelicon",class:0==t.row.wxStatus?"xcxicongray":1==t.row.wxStatus?"xcxicon":"",attrs:{title:0==t.row.wxStatus?"未使用小程序":1==t.row.wxStatus?"已使用小程序":""}}),e._v(" "),a("span",{staticClass:"channelicon",class:0==t.row.status?"gzhiconcanclegray":1==t.row.status?"gzhicon":"gzhicongray",attrs:{title:0==t.row.status?"取消关注公众号":1==t.row.status?"已关注公众号":"未关注公众号"}})])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"gradeName",label:"会员等级"}}),e._v(" "),a("el-table-column",{attrs:{prop:"costAll",sortable:"custom",label:"消费总额"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.costFee))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"costTimes",sortable:"custom",label:"消费次数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"lastCostTime",sortable:"custom",label:"最近消费时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("div",[e._v(" "+e._s(e._f("formatTimeYMD")(t.row.lastCostTime))+" ")]),e._v(" "),a("div",[e._v(" "+e._s(e._f("formatTimeHMS")(t.row.lastCostTime))+" ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",sortable:"custom",label:"新增时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("div",[e._v(" "+e._s(e._f("formatTimeYMD")(t.row.createTime))+" ")]),e._v(" "),a("div",[e._v(" "+e._s(e._f("formatTimeHMS")(t.row.createTime))+" ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"operate"},[a("router-link",{staticClass:"operate-btn",attrs:{to:{path:"/wechatmemberDetail",query:{memberId:t.row.memberId,channel:"wxMember"}}}},[e._v("查看")])],1)]}}])})],1),e._v(" "),e.memberData.length>0?a("div",{staticClass:"page"},[a("el-pagination",{attrs:{background:"","current-page":e.page.currentPage,"page-sizes":[20,40,60,80],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)])]),e._v(" "),a("vue-gic-footer")],1)},staticRenderFns:[]};var g=a("VU/8")(m,u,!1,function(e){a("DwIv")},"data-v-4d639500",null);t.default=g.exports}});