webpackJsonp([30],{"4lFz":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),s=a.n(r),i=a("fZjL"),o=a.n(i),n=a("UXnk"),l=a("+vdD"),c=a("AKaA"),m=a("WSiR"),d=a("NTL1"),u=a("8V46"),g=a("oAV5"),p=a("SJI6"),h=[],b={name:"wechatmembers",data:function(){return{load:!1,phoneNameNick:"",isdot:!1,bodyHeight:document.body.clientHeight||document.documentElement.clientHeight,storeId:this.$route.query.storeId||"",toggleTag:!1,peopleVisible:!1,memberSearchStr:-1,navpath:[{name:"首页",path:""},{name:"会员列表",path:"/posmembers"},{name:"回收站门店会员",path:""}],sceneValue:"member",tableData:[],base:!1,pageName:"wxMember",page:{currentPage:1,pageSize:20,totalCount:0},memberData:[],memberFields:[],sortColName:"",sortType:"desc",fieldsStr:[],dialogFieldVisible:!1,checkedFields:[],multipleList:[],selectAll:!1,batchValue:"",dialogIntegralVisible:!1,IntegralForm:{editType:1,accumulatPoints:0,remark:"",settlementStoreId:""},storeList:[],loading:!1,rules:{editType:[{required:!0,message:"请选择调整方式",trigger:"change"}],accumulatPoints:[{required:!0,message:"请选择调整额度",trigger:"change"}],remark:[{required:!0,message:"请输入原因备注",trigger:"change"}]},dialogGradeVisible:!1,gradeForm:{gradeId:"",remark:""},memberGrade:[],graderules:{gradeId:[{required:!0,message:"请选择等级",trigger:"change"}],remark:[{required:!0,message:"请输入原因备注",trigger:"change"}]},mainstorerules:{remark:[{required:!0,message:"请输入原因备注",trigger:"change"}]},projectName:"member",showStoreDialog:!1,dialogMainstoreVisible:!1,mainstoreForm:{remark:"",optType:1,mainOptType:1,mainStoreId:""},storeName:"",dialogProcessVisible:!1,processList:[],timer:null,dialogSubStoreVisible:!1,storeForm:{remark:"",optType:2,subOptType:1,fromSubStoreId:"",toSubStoreId:"",phoneNameCard:"",premodefiySubStoreId:"",modefiySubStoreId:"",deleteSubStoreId:"",addSubStoreId:"",modefiySubStoreName:"",addSubStoreName:""},storerules:{remark:[{required:!0,message:"请输入原因备注",trigger:"change"}]},subStoreList:[],singleInfo:{sex:0,age:0,cardNo:0,mainStoreName:"dd",costFee:0,costTimes:0,lastCost:0,numOfSale:0,numOfmarket:0,couponCount:0,status:0,wxStatus:0,phoneStatus:0,authStatus:0},integralFlag:""}},computed:s()({},Object(p.mapState)(["storeImageUrl"])),filters:{formatField:function(e){var t="";return"name"==e&&(t="基本信息"),"grade"==e&&(t="会员等级"),"status"==e&&(t="状态"),"channel"==e&&(t="关联渠道"),"cardGivingTime"==e&&(t="开卡时间"),"createTime"==e&&(t="新增时间"),"attentionDate"==e&&(t="关注时间"),"costAll"==e&&(t="消费总额"),"costTimes"==e&&(t="消费次数"),"lastCostTime"==e&&(t="最近消费"),"avgCost"==e&&(t="客单价"),"avgNumber"==e&&(t="连带率"),"costCategory"==e&&(t="消费品类"),"discountRate"==e&&(t="平均折扣"),"cancelAttentionTime"==e&&(t="取关时间"),"age"==e&&(t="年龄"),"birthday"==e&&(t="生日"),"storedValueAll"==e&&(t="储值总额"),"storedValueCurrent"==e&&(t="储值余额"),"pointsAll"==e&&(t="累计积分"),"pointsCurrent"==e&&(t="积分余额"),"mainStoreName"==e&&(t="主门店"),"createCardStoreName"==e&&(t="开卡门店"),"cardNo"==e&&(t="会员卡号"),"frozenStatus"==e&&(t="会员冻结状态"),t},formatFieldName:function(e){var t=h.findIndex(function(t){return t.code==e});return h[t].name},formatMember:function(e){return e&&e.length>3&&(e=e.substr(0,3)+"..."),e},formatCardName:function(e){return e&&e.length>10&&(e=e.substr(0,10)+"..."),e},formatTimeYMD:function(e){return"--"!=e?e.split(" ")[0]:"--"},formatTimeHMS:function(e){return"--"!=e?e.split(" ")[1]:"--"},formatProcess:function(e){var t=100*e.finishCount/e.taskCount,a=parseFloat(t);if(!isNaN(a))return a=Math.round(100*t)/100}},watch:{processList:function(e,t){var a=this;if(e.length<=0){clearInterval(this.timer),this.getAjaxMembers()}else{clearInterval(this.timer),this.timer=setInterval(function(){a.getProcessList()},5e3)}},phoneNameCard:function(e){sessionStorage.setItem("phoneNameCard",e)}},methods:{getData:function(){this.$refs.peopleFilter.confirmSet()},findFilter:function(e){this.memberSearchStr=e,this.getAjaxMembers()},cancelFilter:function(){this.$refs.peopleFilter.cancelSet()},getBackData:function(e){this.groupForm.indexSearchStr=e},editShow:function(){this.toggleTag=!0},editHide:function(){this.toggleTag=!1},hideBtn:function(){},saveTempData:function(){},formatTime:function(e){var t=new Date(e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()<10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()<10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},linkDetail:function(e){this.$router.push({path:"/posmemberDetail",query:{memberId:e}})},showSingleInfo:function(e){var t=this;this.singleInfo="",Object(c.a)(d.a.singleInfo,{memberId:e}).then(function(e){if(0===e.data.errorCode){var a=e.data.result.memberSingle;t.singleInfo=s()({},a,{sex:0==a.sex?"性别未知":1==a.sex?"男":"女",age:0!=a.age?a.age:"年龄未知",cardNo:a.cardNo?a.cardNo:"无会员卡",mainStoreName:a.mainStoreName?a.mainStoreName:"主门店未知"})}else Object(u.a)(e.data.message)}).catch(function(e){Object(u.b)(e)})},changeSubStore:function(){1==this.storeForm.subOptType&&(this.storeForm.modefiySubStoreName="",this.storeForm.modefiySubStoreId="",this.storeForm.deleteSubStoreId=""),2==this.storeForm.subOptType&&(this.storeForm.addSubStoreName="",this.storeForm.addSubStoreId="",this.storeForm.deleteSubStoreId=""),3==this.storeForm.subOptType&&(this.storeForm.addSubStoreName="",this.storeForm.addSubStoreId="",this.storeForm.modefiySubStoreName="",this.storeForm.modefiySubStoreId="")},submitStore:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var r=[];if(!(t.multipleList.length>0))return Object(u.a)("会员不能为空"),!1;if(t.multipleList.forEach(function(e){r.push(e.memberId)}),1==t.storeForm.subOptType){if(""==t.storeForm.addSubStoreId)return Object(u.a)("请选择新增协管门店"),!1;t.storeForm.fromSubStoreId=t.storeForm.addSubStoreId}if(2==t.storeForm.subOptType){if(""==t.storeForm.premodefiySubStoreId)return Object(u.a)("请选择协管门店"),!1;if(""==t.storeForm.modefiySubStoreId)return Object(u.a)("请选择要修改后的协管门店"),!1;t.storeForm.fromSubStoreId=t.storeForm.premodefiySubStoreId,t.storeForm.toSubStoreId=t.storeForm.modefiySubStoreId}3==t.storeForm.subOptType&&(t.storeForm.fromSubStoreId=t.storeForm.deleteSubStoreId),Object(c.a)(d.a.batchUpdateStore,{memberIds:r.join(","),remark:t.storeForm.remark,isCurrent:1==t.selectAll?2:t.multipleList.length==t.page.pageSize?1:0,optType:t.storeForm.optType,subOptType:t.storeForm.subOptType,fromSubStoreId:t.storeForm.fromSubStoreId,toSubStoreId:2==t.storeForm.subOptType?t.storeForm.toSubStoreId:"",phoneNameCard:t.phoneNameCard,listSign:"MemberProcessed",listSignId:t.storeId,sortField:"",phoneNameNick:t.phoneNameNick}).then(function(a){if(t.$refs[e].resetFields(),0!==a.data.errorCode)return Object(u.a)(a.data.message),t.dialogSubStoreVisible=!1,!1;Object(u.c)(),t.dialogSubStoreVisible=!1}).then(function(){setTimeout(function(){t.getProcessList()},30)}).catch(function(a){Object(u.b)(a),t.dialogSubStoreVisible=!1,t.$refs[e].resetFields()})})},getSubStoreList:function(){var e=this,t=[];if(!(this.multipleList.length>0))return Object(u.a)("会员不能为空"),!1;this.multipleList.forEach(function(e){t.push(e.memberId)}),Object(c.a)(d.a.membersSubStoreList,{memberIds:t.join(","),isCurrent:1==this.selectAll?2:this.multipleList.length==this.page.pageSize?1:0,pageName:"wxMember",phoneNameCard:this.phoneNameCard}).then(function(t){0===t.data.errorCode?e.subStoreList=t.data.result.storeList:Object(u.a)(t.data.message)}).catch(function(e){Object(u.b)(e)})},closeProcess:function(){clearInterval(this.timer)},getBatchProcess:function(){this.dialogProcessVisible=!0},callProcess:function(){this.getProcessList()},getProcessList:function(){var e=this;Object(c.a)(d.a.batchProcess).then(function(t){0===t.data.errorCode?(e.isdot=t.data.result.list.length>0,e.processList=t.data.result.list.map(function(e){return s()({},e,{name:e.name?e.name:"未知"})})):Object(u.a)(t.data.message)}).catch(function(e){Object(u.b)(e)})},submitMainStore:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var r=[];return t.multipleList.length>0?(t.multipleList.forEach(function(e){r.push(e.memberId)}),4==t.mainstoreForm.mainOptType&&""==t.mainstoreForm.mainStoreId?(Object(u.a)("自定义门店不能为空"),!1):void Object(c.a)(d.a.batchUpdateStore,{memberIds:r.join(","),remark:t.mainstoreForm.remark,isCurrent:1==t.selectAll?2:t.multipleList.length==t.page.pageSize?1:0,optType:t.mainstoreForm.optType,mainOptType:t.mainstoreForm.mainOptType,mainStoreId:t.mainstoreForm.mainStoreId,listSign:"MemberProcessed",listSignId:t.storeId,sortField:"",phoneNameNick:t.phoneNameNick,memberListType:1}).then(function(a){if(t.$refs[e].resetFields(),t.storeName="",0!==a.data.errorCode)return Object(u.a)(a.data.message),t.dialogMainstoreVisible=!1,!1;Object(u.c)(),t.getAjaxMembers(),t.dialogMainstoreVisible=!1,t.sortColName="",t.sortType="desc",t.phoneNameCard=""}).then(function(){setTimeout(function(){t.getProcessList()},30)}).catch(function(a){Object(u.b)(a),t.dialogMainstoreVisible=!1,t.$refs[e].resetFields()})):(Object(u.a)("会员不能为空"),!1)})},handleStore:function(){4==this.mainstoreForm.mainOptType&&(this.showStoreDialog=!0),4!==this.mainstoreForm.mainOptType&&(this.mainstoreForm.mainStoreId="",this.storeName="")},changeStore:function(){this.showStoreDialog=!0},selectStore:function(e){o()(e).length>0&&("mainstore"==this.batchValue&&(this.mainstoreForm.mainStoreId=e.storeId,this.storeName=e.storeName,this.mainstoreForm.mainOptType=4),"store"==this.batchValue&&(1===this.storeForm.subOptType&&(this.storeForm.addSubStoreId=e.storeId,this.storeForm.addSubStoreName=e.storeName),2===this.storeForm.subOptType&&(this.storeForm.modefiySubStoreId=e.storeId,this.storeForm.modefiySubStoreName=e.storeName))),this.showStoreDialog=!1},submitGrade:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var r=[];if(!(t.multipleList.length>0))return Object(u.a)("会员不能为空"),!1;t.multipleList.forEach(function(e){r.push(e.memberId)}),Object(c.a)(d.a.updateGrade,{memberIds:1==t.selectAll?"-1":r.join(","),remark:t.gradeForm.remark,gradeId:t.gradeForm.gradeId,isCurrent:1==t.selectAll?2:t.multipleList.length==t.page.pageSize?1:0,memberSearchParamStr:1==t.selectAll?t.memberSearchStr?t.memberSearchStr:"-1":"",phoneNameCard:t.phoneNameCard}).then(function(a){if(t.$refs[e].resetFields(),0!==a.data.errorCode)return Object(u.a)(a.data.message),t.dialogGradeVisible=!1,!1;Object(u.c)(),t.dialogGradeVisible=!1}).then(function(){setTimeout(function(){t.getProcessList()},30)}).catch(function(a){Object(u.b)(a),t.dialogGradeVisible=!1,t.$refs[e].resetFields()})})},getGradeList:function(){var e=this;Object(c.a)(d.a.gradeList).then(function(t){if(0!==t.data.errorCode)return Object(u.a)(t.data.message),!1;e.memberGrade=t.data.result}).catch(function(e){Object(u.b)(e)})},closeGrade:function(e){this.$refs[e]&&this.$refs[e].resetFields()},getEnterpriseInfo:function(){var e=this;Object(c.a)(d.a.enterpriseInfo).then(function(t){0==t.data.errorCode?e.integralFlag=t.data.result.enterpriseInfo.integralFlag:Object(u.a)()}).catch(function(e){Object(u.b)(e)})},closeIntegral:function(e){this.IntegralForm.settlementStoreId="",this.$refs[e]&&this.$refs[e].resetFields()},submitIntegral:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var r=[];if(!(t.multipleList.length>0))return Object(u.a)("会员不能为空"),!1;t.multipleList.forEach(function(e){r.push(e.memberId)}),Object(c.a)(d.a.updateIntegrals,{memberIds:1==t.selectAll?"-1":r.join(","),remark:t.IntegralForm.remark,accumulatPoints:t.IntegralForm.accumulatPoints,editType:t.IntegralForm.editType,settlementStoreId:t.IntegralForm.settlementStoreId,isCurrent:1==t.selectAll?2:t.multipleList.length==t.page.pageSize?1:0,memberSearchParamStr:1==t.selectAll?t.memberSearchStr?t.memberSearchStr:"-1":"",phoneNameCard:t.phoneNameCard}).then(function(a){return t.$refs[e]&&t.$refs[e].resetFields(),0===a.data.errorCode?(Object(u.c)(),!0):(Object(u.a)(),!1)}).then(function(e){t.IntegralForm.settlementStoreId="",t.dialogIntegralVisible=!1,e&&setTimeout(function(){t.getProcessList()},30)}).catch(function(a){Object(u.b)(a),t.dialogIntegralVisible=!1,t.$refs[e].resetFields()})})},handleKeyup:function(e){this.getStoreCodeName(e)},getStoreCodeName:function(e){var t=this;Object(c.b)(d.a.storeCodeName,{searchParam:e,flag:1}).then(function(e){0===e.data.errorCode?t.storeList=e.data.result:Object(u.a)(e.data.message)}).catch(function(e){Object(u.b)(e)})},handleMainStore:function(){if(this.multipleList.length<1)return this.batchValue="",Object(u.a)("请勾选会员"),!1;this.dialogMainstoreVisible=!0,this.$refs.mainstoreForm&&this.$refs.mainstoreForm.resetFields(),this.storeName=""},handleVisibleBatch:function(){if(this.multipleList.length<1)return this.batchValue="",Object(u.a)("请勾选会员"),!1;"mainstore"==this.batchValue&&(this.dialogMainstoreVisible=!0,this.$refs.mainstoreForm&&this.$refs.mainstoreForm.resetFields(),this.storeName=""),"store"==this.batchValue&&(this.dialogSubStoreVisible=!0,this.$refs.storeForm&&this.$refs.storeForm.resetFields(),this.getSubStoreList())},handleFocusBatch:function(){if(this.multipleList.length<1)return this.batchValue="",Object(u.a)("请勾选会员"),!1},selectAllmultipleList:function(){var e=this;this.selectAll=!this.selectAll,this.selectAll?this.memberData.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t,!0)}):this.$refs.multipleTable.clearSelection()},handleCurrentChange:function(e){this.page.currentPage=e,sessionStorage.setItem("currentPage",e),this.getAjaxMembers()},handleSizeChange:function(e){this.page.pageSize=e,this.getAjaxMembers()},sortChange:function(e,t,a){this.sortColName=e.prop,"descending"===e.order&&(this.sortType="desc"),"ascending"===e.order&&(this.sortType="asc"),this.getAjaxMembers()},submitFields:function(){var e=this,t="";this.checkedFields.length>0&&(t=this.checkedFields.join(",")),Object(c.a)(d.a.updateFields,{pageName:this.pageName,fields:t}).then(function(t){0===t.data.errorCode?(Object(u.c)(),e.memberData=[],e.fieldsStr=[],e.getAjaxMembers()):Object(u.a)(t.data.message),e.dialogFieldVisible=!1}).catch(function(t){Object(u.b)(t),e.dialogFieldVisible=!1})},handleMemberFields:function(){this.dialogFieldVisible=!0,this.checkedFields=[],this.memberFields=[],h=[],this.getFindMemberFields()},getFindMemberFields:function(){var e=this;Object(c.a)(d.a.findMemberFields,{pageName:this.pageName}).then(function(t){if(0===t.data.errorCode){var a=t.data.result;h=a,a.forEach(function(t){t.check&&e.checkedFields.push(t.code),e.memberFields.push(t.code)})}else Object(u.a)(t.data.message)}).catch(function(e){Object(u.b)(e)})},getAjaxMembers:function(){var e=this;Object(c.a)(d.a.getReturnMember,{storeId:this.storeId,listSign:"MemberProcessed",pageSize:this.page.pageSize,currentPage:this.page.currentPage,phoneNameNick:this.phoneNameNick,memberListType:1}).then(function(t){e.load=!0,0===t.data.errorCode?(e.load=!1,t.data.result.page.result?(e.memberData=t.data.result.page.result.map(function(t){return s()({},t,{avgNumber:t.avgNumber.toFixed(2),lastCostTime:-1!=t.lastCostTime?Object(g.a)(t.lastCostTime,2):"--",createTime:-1!=t.createTime?Object(g.a)(t.createTime,2):"--",attentionDate:-1!=t.attentionDate?Object(g.a)(t.attentionDate,2):"--",cancelAttentionTime:-1!=t.cancelAttentionTime?Object(g.a)(t.cancelAttentionTime,2):"--",attentionTime:-1!=t.attentionTime?Object(g.a)(t.attentionTime,2):"--",crateCardDateString:-1!=t.crateCardDateString?Object(g.a)(t.crateCardDateString,1):"--",birthdayMD:0!=t.birthdayMD?Object(g.c)(t.birthdayMD):"--",sex:0==t.sex?"性别未知":1==t.sex?"男":"女",age:t.age?t.age:"年龄未知",cardNo:t.cardNo?t.cardNo:"无会员卡",mainStoreName:t.mainStoreName?t.mainStoreName:"主门店未知",thirdImgUrl:t.thirdImgUrl?t.thirdImgUrl:e.storeImageUrl})}),e.page.currentPage=t.data.result.page.currentPage,e.page.totalCount=t.data.result.page.totalCount):(e.memberData=[],e.page.totalCount=0,e.page.currentPage=0)):Object(u.a)(t.data.message)}).catch(function(e){Object(u.b)(e)})},handleSelectionChange:function(e){this.multipleList=e},handleSearch:function(e){this.phoneNameCard=e.target.value,this.page.currentPage=1,this.getAjaxMembers()},initialize:function(){this.phoneNameCard=sessionStorage.getItem("phoneNameCard")?sessionStorage.getItem("phoneNameCard"):"",this.page.currentPage=sessionStorage.getItem("currentPage")?sessionStorage.getItem("currentPage"):1}},created:function(){this.storeImageUrl||this.$store.dispatch("getStorePicture"),this.getProcessList(),this.initialize(),this.$store.commit("mutations-slide",!1)},beforeMount:function(){this.getAjaxMembers()},mounted:function(){},components:{searchinput:n.a,Navbar:l.a,NavPath:m.a}},f=s()({},b),v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"member-return",style:{height:e.bodyHeight-64+"px"}},[a("div",{staticClass:"member-container"},[a("nav-path",{attrs:{navpath:e.navpath}}),e._v(" "),a("div",{staticClass:"return-container"},[a("div",{staticClass:"handler"},[e.multipleList.length==e.page.pageSize?a("p",{staticClass:"multiple"},[0==e.selectAll?a("span",[e._v("已勾选本页 "+e._s(e.multipleList.length)+" 个会员，")]):a("span",[e._v("已勾选 "+e._s(e.page.totalCount)+" 个会员，")]),e._v(" "),0==e.selectAll?a("span",{staticClass:"multiple-all pointer",on:{click:e.selectAllmultipleList}},[e._v("勾选全部 "+e._s(e.page.totalCount)+" 个会员")]):a("span",{staticClass:"multiple-all pointer",on:{click:e.selectAllmultipleList}},[e._v("取消勾选")])]):e._e(),e._v(" "),a("div",{staticClass:"handler-search"},[e._v("\n          会员共"+e._s(e.page.totalCount)+"人\n          "),e._v(" "),a("el-input",{staticStyle:{width:"249px"},attrs:{maxlength:"32",placeholder:"输入手机号码",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.phoneNameNick,callback:function(t){e.phoneNameNick=t},expression:"phoneNameNick"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("div",{staticClass:"handler-setting"},[a("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"批量操作"},on:{change:e.handleFocusBatch,"visible-change":e.handleVisibleBatch},model:{value:e.batchValue,callback:function(t){e.batchValue=t},expression:"batchValue"}},[a("el-option",{key:"mainstore",attrs:{label:"修改主门店",value:"mainstore"}})],1),e._v(" "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"450",trigger:"hover"},on:{show:e.callProcess}},[e.processList.length>0?a("div",e._l(e.processList,function(t,r){return a("div",{key:r},[a("span",{staticClass:"process-span"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticStyle:{display:"inline-block",width:"300px"}},[a("el-progress",{attrs:{percentage:0==t.taskCount?100:+(100*t.finishCount/t.taskCount).toFixed(2)}})],1)])}),0):a("div",{staticStyle:{"text-align":"center"}},[e._v("\n                暂无批量处理数据\n              ")]),e._v(" "),a("el-badge",{staticClass:"item",attrs:{slot:"reference","is-dot":e.isdot},slot:"reference"},[a("el-button",{staticStyle:{width:"32px","line-height":"30px",padding:"0px"},attrs:{type:"primary",icon:"el-icon-time"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"tablecontent"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"}],ref:"multipleTable",attrs:{data:e.memberData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"基本信息",prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"tablecontent-cell",staticStyle:{cursor:"pointer"},on:{click:function(a){return e.linkDetail(t.row.memberId)}}},[a("el-popover",{attrs:{placement:"top-start",width:"400",height:"180",trigger:"hover"},on:{show:function(a){return e.showSingleInfo(t.row.memberId)}}},[a("div",{staticClass:"pointer",on:{click:function(a){return e.linkDetail(t.row.memberId)}}},[a("div",{staticClass:"singelinfo"},[a("div",{staticClass:"singelinfo-img"},[a("img",{attrs:{width:"100",height:"100",src:t.row.thirdImgUrl?t.row.thirdImgUrl:"./static/img/default.png",alt:""}})]),e._v(" "),a("div",{staticClass:"singelinfo-content pLeft10 pRight10"},[a("span",{staticClass:"lheigth0"},[e._v(e._s(t.row.memberName)+"\n                            "),a("span",{staticClass:"channelicon fr",class:0==e.singleInfo.status?"gzhiconcanclegray":1==e.singleInfo.status?"gzhicon":"gzhicongray",attrs:{title:0==e.singleInfo.status?"取消关注公众号":1==e.singleInfo.status?"已关注公众号":"未关注公众号"}}),e._v(" "),a("span",{staticClass:"channelicon fr mr6",class:0==e.singleInfo.wxStatus?"xcxicongray":1==e.singleInfo.wxStatus?"xcxicon":"",attrs:{title:0==e.singleInfo.wxStatus?"未使用小程序":1==e.singleInfo.wxStatus?"使用过小程序":""}})]),e._v(" "),a("p",{staticClass:"lheigth0"},[a("span",{staticClass:"evl-right"},[e._v(e._s(e.singleInfo.sex))]),e._v(" "),a("span",{staticClass:"evl-right"},[e._v(e._s(e.singleInfo.age))]),e._v(" "),a("span",{attrs:{title:e.singleInfo.cardNo}},[e._v(e._s(e._f("formatCardName")(e.singleInfo.cardNo)))])]),e._v(" "),a("p",{staticClass:"lheigth0"},[a("span",[e._v(e._s(e.singleInfo.mainStoreName))])]),e._v(" "),a("div",{staticClass:"singelinfo-cost"},[a("div",{staticClass:"singelinfo-costitem"},[a("p",[e._v(e._s(e.singleInfo.costFee))]),e._v(" "),a("p",[e._v("消费总额")])]),e._v(" "),a("div",{staticClass:"singelinfo-costitem"},[a("p",[e._v(e._s(e.singleInfo.costTimes))]),e._v(" "),a("p",[e._v("消费次数")])]),e._v(" "),a("div",{staticClass:"singelinfo-costitem"},[a("p",[e._v(e._s(e.singleInfo.lastCost))]),e._v(" "),a("p",[e._v("最近消费")])])])])]),e._v(" "),a("div",{staticClass:"singelinfo-jl mBottom20 mTop20"},[a("a",{staticClass:"singelinfo-jlitem"},[e._v("消费记录 ("+e._s(e.singleInfo.numOfSale)+")")]),e._v(" "),a("a",{staticClass:"singelinfo-jlitem"},[e._v("营销记录 ("+e._s(e.singleInfo.numOfmarket)+")")]),e._v(" "),a("a",{staticClass:"singelinfo-jlitem"},[e._v("卡券记录 ("+e._s(e.singleInfo.couponCount)+")")])])]),e._v(" "),a("span",{staticClass:"member-span",attrs:{slot:"reference"},slot:"reference"},[a("img",{staticClass:"tablecontent-cellimg mr6",attrs:{width:"60",height:"60",src:t.row.thirdImgUrl?t.row.thirdImgUrl:"./static/img/default.png",alt:""}})])]),e._v(" "),a("span",{staticClass:"fix-block"},[e._v(e._s(e._f("formatMember")(t.row.memberName)))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"会员等级",prop:"grade"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.gradeName?t.row.gradeName:"--"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[a("span",{staticClass:"channelicon",class:0==t.row.wxStatus?"xcxicongray":1==t.row.wxStatus?"xcxicon":"",attrs:{title:0==t.row.wxStatus?"未使用小程序":1==t.row.wxStatus?"已使用小程序":""}}),e._v(" "),a("span",{staticClass:"channelicon",class:0==t.row.status?"gzhiconcanclegray":1==t.row.Status?"gzhicon":"gzhicongray",attrs:{title:0==t.row.status?"取消关注公众号":1==t.row.status?"已关注公众号":"未关注公众号"}})])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"消费总额",prop:"costFee"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(null!==t.row.costFee?t.row.costFee:"--"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"消费次数",prop:"costTimes"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.costTimes)+"\n              ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"operate"},[a("router-link",{staticClass:"operate-btn",attrs:{to:{path:"/posmemberDetail",query:{memberId:t.row.memberId,channel:"wxMember"}}}},[e._v("查看")])],1)]}}])})],1),e._v(" "),e.memberData.length>0?a("div",{staticClass:"page mTop20 mBottom40"},[a("el-pagination",{attrs:{background:"","current-page":e.page.currentPage,"page-sizes":[20,40,60,80],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)]),e._v(" "),a("el-dialog",{attrs:{title:"自定义字段列表",visible:e.dialogFieldVisible,width:"600px"},on:{"update:visible":function(t){e.dialogFieldVisible=t}}},[a("div",{staticClass:"checkwtip mBottom10"},[e._v("请选择您想显示的列表详细信息，最多勾选8个选项，已经勾选了 "),a("span",{staticClass:"curcheck"},[e._v(e._s(e.checkedFields.length))]),e._v(" 个")]),e._v(" "),a("el-checkbox-group",{attrs:{min:3,max:8},model:{value:e.checkedFields,callback:function(t){e.checkedFields=t},expression:"checkedFields"}},[a("div",{staticClass:"checkwrap"},e._l(e.memberFields,function(t,r){return a("div",{key:r,staticClass:"checkwrap-item lheigth30"},[a("el-checkbox",{key:t,attrs:{label:t}},[e._v(e._s(e._f("formatFieldName")(t)))])],1)}),0)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFieldVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitFields}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"批量调整积分",visible:e.dialogIntegralVisible,width:"600px"},on:{"update:visible":function(t){e.dialogIntegralVisible=t},close:function(t){return e.closeIntegral("IntegralForm")}}},[a("el-form",{ref:"IntegralForm",attrs:{model:e.IntegralForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"调整积分",prop:"editType"}},[a("el-radio-group",{model:{value:e.IntegralForm.editType,callback:function(t){e.$set(e.IntegralForm,"editType",t)},expression:"IntegralForm.editType"}},[a("el-radio",{attrs:{label:1}},[e._v("增加积分")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("扣除积分")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"调整额度",prop:"accumulatPoints"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,max:1e5},model:{value:e.IntegralForm.accumulatPoints,callback:function(t){e.$set(e.IntegralForm,"accumulatPoints",t)},expression:"IntegralForm.accumulatPoints"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"原因备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.IntegralForm.remark,callback:function(t){e.$set(e.IntegralForm,"remark",t)},expression:"IntegralForm.remark"}})],1),e._v(" "),"gic"==e.integralFlag?a("el-form-item",{attrs:{label:"原始成本主题"}},[a("el-select",{attrs:{prop:"settlementStoreId",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":e.handleKeyup,loading:e.loading},model:{value:e.IntegralForm.settlementStoreId,callback:function(t){e.$set(e.IntegralForm,"settlementStoreId",t)},expression:"IntegralForm.settlementStoreId"}},e._l(e.storeList,function(e){return a("el-option",{key:e.storeId,attrs:{label:e.storeName,value:e.storeId}})}),1)],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogIntegralVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitIntegral("IntegralForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"批量调整会员等级",visible:e.dialogGradeVisible,width:"600px"},on:{"update:visible":function(t){e.dialogGradeVisible=t}}},[a("el-form",{ref:"gradeForm",attrs:{model:e.gradeForm,rules:e.graderules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"调整后等级",prop:"gradeId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.gradeForm.gradeId,callback:function(t){e.$set(e.gradeForm,"gradeId",t)},expression:"gradeForm.gradeId"}},e._l(e.memberGrade,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"原因备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.gradeForm.remark,callback:function(t){e.$set(e.gradeForm,"remark",t)},expression:"gradeForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogGradeVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitGrade("gradeForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改主门店",visible:e.dialogMainstoreVisible,width:"600px"},on:{"update:visible":function(t){e.dialogMainstoreVisible=t}}},[a("el-form",{ref:"mainstoreForm",attrs:{model:e.mainstoreForm,rules:e.mainstorerules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"选择主门店",prop:"mainOptType"}},[a("el-radio-group",{on:{change:e.handleStore},model:{value:e.mainstoreForm.mainOptType,callback:function(t){e.$set(e.mainstoreForm,"mainOptType",t)},expression:"mainstoreForm.mainOptType"}},[a("p",{staticClass:"lheigth40"},[a("el-radio",{attrs:{label:1}},[e._v("替换为最新协管的门店 ")])],1),e._v(" "),a("p",{staticClass:"lheigth40"},[a("el-radio",{attrs:{label:2}},[e._v("替换为最新协管的自营门店")])],1),e._v(" "),a("p",{staticClass:"lheigth40"},[a("el-radio",{attrs:{label:3}},[e._v("替换为最新协管的自营/联营门店")])],1),e._v(" "),a("p",{staticClass:"lheigth40"},[a("el-radio",{attrs:{label:4}},[e._v("自定义主门店")])],1)]),e._v(" "),""!==e.storeName?a("p",{staticStyle:{"line-height":"0","margin-left":"22px"}},[e._v(e._s(e.storeName)),a("span",{staticClass:"ml15 pointer",on:{click:e.changeStore}},[e._v("修改")])]):a("p",{staticStyle:{"line-height":"0","margin-left":"22px"}},[a("span",{staticClass:"pointer",on:{click:e.changeStore}},[e._v("点击选择主门店")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"原因备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.mainstoreForm.remark,callback:function(t){e.$set(e.mainstoreForm,"remark",t)},expression:"mainstoreForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogMainstoreVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitMainStore("mainstoreForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"批量修改协管门店",visible:e.dialogSubStoreVisible,width:"800px"},on:{"update:visible":function(t){e.dialogSubStoreVisible=t}}},[a("el-form",{ref:"storeForm",attrs:{model:e.storeForm,rules:e.storerules,"label-width":"120px"}},[a("p",{staticClass:"ml15"},[e._v("当前选择"+e._s(e.multipleList.length)+"个会员")]),e._v(" "),a("el-form-item",{attrs:{label:"选择协管门店",prop:"subOptType"}},[a("el-radio",{attrs:{label:1},on:{change:e.changeSubStore},model:{value:e.storeForm.subOptType,callback:function(t){e.$set(e.storeForm,"subOptType",t)},expression:"storeForm.subOptType"}},[e._v("\n              增加协管门店\n              "),a("span",{staticStyle:{color:"#000"}},[e._v(e._s(e.storeForm.addSubStoreName))]),e._v(" "),1==e.storeForm.subOptType?a("span",{staticClass:"pointer",staticStyle:{color:"#000"},on:{click:e.changeStore}},[e._v("选择门店")]):e._e()])],1),e._v(" "),a("el-form-item",{attrs:{label:"原因备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.storeForm.remark,callback:function(t){e.$set(e.storeForm,"remark",t)},expression:"storeForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSubStoreVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitStore("storeForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"查看批量处理进度",visible:e.dialogProcessVisible,width:"600px"},on:{"update:visible":function(t){e.dialogProcessVisible=t},close:e.closeProcess}},[e._l(e.processList,function(t,r){return a("div",{key:r,staticClass:"process"},[a("span",{staticClass:"process-name"},[e._v(e._s(t.name))]),a("span",{staticClass:"process-status"},[a("el-progress",{attrs:{percentage:e._f("formatProcess")(t)}})],1)])}),e._v(" "),e.processList.length<=0?a("p",[e._v("暂无批量处理")]):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogProcessVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogProcessVisible=!1}}},[e._v("确 定")])],1)],2),e._v(" "),a("vue-gic-store",{attrs:{projectName:e.projectName,showStoreDialog:e.showStoreDialog},on:{selectStore:e.selectStore}})],1)],1),e._v(" "),a("div",{staticClass:"foot-add"},[a("vue-gic-footer")],1)])},staticRenderFns:[]};var S=a("VU/8")(f,v,!1,function(e){a("9r5c")},null,null);t.default=S.exports},"9r5c":function(e,t){}});