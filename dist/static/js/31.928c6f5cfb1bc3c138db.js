webpackJsonp([31],{VPyt:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),l=a.n(i),r=a("WSiR"),n=a("AKaA"),s=a("NTL1"),o=a("8V46"),c={name:"labelmanager",data:function(){return{addTagCount:0,bodyHeight:document.body.clientHeight||document.documentElement.clientHeight,collapseFlag:!1,leftModulesName:"会员标签",projectName:"member",inputVisible:!1,inputValue:"",navpath:[{name:"首页",path:""},{name:"会员标签",path:""}],dilogLabelFormVisible:!1,dilogAddFormVisible:!1,labelForm:{tagName:"",tagDescribe:""},addLabelForm:{tagName:""},tagList:[],curpTagId:null}},created:function(){this.$store.commit("mutations-slide",!1),this.TimeFlag=!1},methods:{showInput:function(e,t){var a=this;e.inputVisible=!0,this.curpTagId=e.pTagId,this.$nextTick(function(e){var i="saveTag"+t;a.$refs[i][0].$refs.input.focus()})},handleInputConfirm:function(e,t,a){var i=this,l=e.inputVal;if(l){e.inputVal="";var r=!0;if(this.tagList[t].sonList.length&&(r=this.tagList[t].sonList.every(function(e){return l!==e.tagName})),!r)return void this.$message.warning("已存在该标签名，不能重复添加！");Object(n.a)(s.a.insertSonTag,{tagName:l,pTagId:this.curpTagId}).then(function(t){if(0===t.data.errorCode)return Object(o.c)(),i.inputVisible=!1,e.inputVal="",i.getLabel(),!1;Object(o.a)(t.data.message),i.dilogAddFormVisible=!1}).catch(function(e){Object(o.b)(e),i.dilogAddFormVisible=!1})}},AddTagType:function(){this.labelForm.tagName="",this.labelForm.tagDescribe="",this.dilogLabelFormVisible=!0},AddParentTag:function(){var e=this;e.$refs.addForm.validate(function(t){if(t){var a=!0;if(e.tagList.length&&(a=e.tagList.every(function(t){return e.labelForm.tagName!==t.tagName})),!a)return void e.$message.warning("已存在该标签类型");if(!e.labelForm.tagName.trim()||!e.labelForm.tagDescribe.trim())return Object(o.a)("标签名称和描述都不能为空"),!1;Object(n.a)(s.a.insertParentTag,{tagName:e.labelForm.tagName,tagDescribe:e.labelForm.tagDescribe}).then(function(t){0===t.data.errorCode?(Object(o.c)(),e.getLabel()):Object(o.a)(t.data.message),e.dilogLabelFormVisible=!1}).catch(function(t){Object(o.b)(t),e.dilogLabelFormVisible=!1})}})},deleteGroup:function(e,t){var a=this,i="",l="";1===t&&(l=s.a.deleteParentTag,i={pTagId:e}),2===t&&(l=s.a.deleteSonTag,i={sTagId:e}),this.$confirm("确认删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.a)(l,i).then(function(e){if(0!==e.data.errorCode)return Object(o.a)(e.data.message),!1;a.getLabel(),Object(o.c)("删除成功")}).catch(function(e){Object(o.b)(e)})}).catch(function(e){a.$message.info("已取消删除")})},submitAddLabel:function(){var e=this;if(this.$refs.addChildForm.validate(function(e){return!e}),!this.addLabelForm.tagName.trim())return Object(o.a)("标签名称不能为空"),!1;Object(n.a)(s.a.insertSonTag,{tagName:this.addLabelForm.tagName,pTagId:this.curpTagId}).then(function(t){0===t.data.errorCode?(Object(o.c)(),e.getLabel()):Object(o.a)(t.data.message),e.dilogAddFormVisible=!1}).catch(function(t){Object(o.b)(t),e.dilogAddFormVisible=!1})},addLabel:function(e){this.dilogAddFormVisible=!0,this.addLabelForm.tagName="",this.curpTagId=e},getLabel:function(){var e=this;Object(n.a)(s.a.tagManageList).then(function(t){if(0!==t.data.errorCode)return Object(o.a)(t.data.message),!1;e.tagList=t.data.result.tagList&&t.data.result.tagList.length&&t.data.result.tagList.map(function(e){return l()({},e,{inputVisible:!1,inputVal:""})})}).catch(function(e){Object(o.b)(e)})}},mounted:function(){var e=this;this.getLabel(),window.onresize=function(){e.bodyHeight=document.body.clientHeight||document.documentElement.clientHeight}},components:{"v-nav":r.a}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"labelmanage",style:{height:e.bodyHeight-64+"px"}},[a("div",{staticClass:"label-container min100"},[a("v-nav",{attrs:{navpath:e.navpath}}),e._v(" "),a("div",{staticClass:"labelcontainer-wrap"},[a("div",{staticClass:"labelcontainer"},[a("div",{staticClass:"tr pad-b-24"},[a("el-button",{attrs:{type:"primary"},on:{click:e.AddTagType}},[e._v("新增标签类型")])],1),e._v(" "),a("div",{staticClass:"labelList marginAuto clear"},e._l(e.tagList,function(t,i){return a("div",{key:i,staticClass:"labelitem"},[a("div",{staticClass:"group"},[a("el-button",{staticClass:"grouptitle",attrs:{size:"small",type:"text"}},[e._v(e._s(t.tagName))]),e._v(" "),a("el-button",{staticClass:"grouptag fr",attrs:{size:"small",type:"danger",plain:""},on:{click:function(a){return e.deleteGroup(t.pTagId,1)}}},[e._v("删除")])],1),e._v(" "),a("div",{staticClass:"group-items"},[e._l(t.sonList,function(t,i){return a("el-tag",{key:i,attrs:{closable:""},on:{close:function(a){return e.deleteGroup(t.sTagId,2)}}},[e._v(" "+e._s(t.tagName)+" ")])}),e._v(" "),t.inputVisible?a("el-input",{ref:"saveTag"+i,refInFor:!0,staticClass:"input-new-tag",staticStyle:{"vertical-align":"inherit"},attrs:{size:"small"},on:{blur:function(a){return e.handleInputConfirm(t,i,a)}},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.handleInputConfirm(t,i,a)}},model:{value:t.inputVal,callback:function(a){e.$set(t,"inputVal",a)},expression:"item.inputVal"}}):a("el-button",{staticClass:"grouptag el-tag",attrs:{size:"small"},on:{click:function(a){return e.showInput(t,i)}}},[e._v("+ 添加标签")])],2)])}),0)])]),e._v(" "),a("el-dialog",{attrs:{title:"新增标签类型",visible:e.dilogLabelFormVisible,width:"574px"},on:{"update:visible":function(t){e.dilogLabelFormVisible=t}}},[a("el-form",{ref:"addForm",staticClass:"dilogForm",attrs:{model:e.labelForm}},[a("el-form-item",{attrs:{label:"类型名称","label-width":"100px",prop:"tagName",rules:[{required:!0,message:"类型名称不能为空",trigger:["blur"]}]}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:e.labelForm.tagName,callback:function(t){e.$set(e.labelForm,"tagName",t)},expression:"labelForm.tagName"}}),e._v(" "),a("gic-input",{attrs:{max:10},model:{value:e.labelForm.tagName,callback:function(t){e.$set(e.labelForm,"tagName",t)},expression:"labelForm.tagName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型描述","label-width":"100px",prop:"tagDescribe",rules:[{required:!0,message:"类型描述不能为空",trigger:["blur"]}]}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:e.labelForm.tagDescribe,callback:function(t){e.$set(e.labelForm,"tagDescribe",t)},expression:"labelForm.tagDescribe"}}),e._v(" "),a("gic-textarea",{attrs:{max:100},model:{value:e.labelForm.tagDescribe,callback:function(t){e.$set(e.labelForm,"tagDescribe",t)},expression:"labelForm.tagDescribe"}})],1)],1),e._v(" "),a("div",{staticClass:"dilog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dilogLabelFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.AddParentTag}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增标签",visible:e.dilogAddFormVisible,width:"574px"},on:{"update:visible":function(t){e.dilogAddFormVisible=t}}},[a("el-form",{ref:"addChildForm",staticClass:"dilogForm",attrs:{model:e.addLabelForm}},[a("el-form-item",{attrs:{label:"标签名称","label-width":"100px",prop:"tagName",rules:[{required:!0,message:"类型描述不能为空",trigger:["blur"]}]}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:e.addLabelForm.tagName,callback:function(t){e.$set(e.addLabelForm,"tagName",t)},expression:"addLabelForm.tagName"}}),e._v(" "),a("gic-input",{attrs:{max:10},model:{value:e.addLabelForm.tagName,callback:function(t){e.$set(e.addLabelForm,"tagName",t)},expression:"addLabelForm.tagName"}})],1)],1),e._v(" "),a("div",{staticClass:"dilog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dilogAddFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitAddLabel}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("div",{staticClass:"foot-add"},[a("vue-gic-footer")],1)])},staticRenderFns:[]};var u=a("VU/8")(c,d,!1,function(e){a("XBch")},"data-v-2a42e610",null);t.default=u.exports},XBch:function(e,t){}});