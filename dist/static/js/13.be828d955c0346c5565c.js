webpackJsonp([13],{"616v":function(e,t){},EFnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),s=a.n(r),o=a("WSiR"),l=a("AKaA"),i=a("NTL1"),n=a("8V46"),c=a("UXnk"),d=a("oAV5"),v={name:"ajaxmembersinfo",data:function(){return{load:!1,replayVisable:!1,textarea:"",evaluate:{},evaluateData:[],memberId:this.$route.query.memberId||"",navpath:[{name:"首页",path:""},{name:"微信会员",path:"/wechatmembers"},{name:"会员详情",path:"/wechatmemberDetail?memberId="+this.$route.query.memberId||""},{name:"会员门店消费",path:""}],memberInfo:{costFee:0,costTimes:0,lastCostTime:"",avgCost:0,relatedPercent:0,avgGoodsCost:0,highCost:0,costCategoryCount:0,avgDiscount:0},orderType:-1,evaluateStatus:-1,searchInfo:"",page:{currentPage:1,pageSize:20,totalCount:0},memberData:[],dilogOrderVisible:!1,orderData:[],orderInfo:"",payInfo:[]}},methods:{getOrderDetail:function(e){var t=this;this.orderData=[],this.orderInfo="",this.orderId=e,this.payInfo=[],Object(l.a)(i.a.orderDetail,{memberId:this.memberId,orderId:e}).then(function(e){if(0===e.data.errorCode){t.dilogOrderVisible=!0,t.orderInfo=e.data.result.orderInfo,t.orderData=e.data.result.orderInfo.list.map(function(e){return s()({},e,{attrColorSize:JSON.parse(e.attrColorSize)})}),t.orderInfo.payInfo&&(t.payInfo=JSON.parse(t.orderInfo.payInfo));var a=e.data.result.orderInfo.evaluate;a?(t.evaluateId=a.evaluateId,t.evaluate=s()({},a,{createTime:-1!=a.createTime?Object(d.a)(a.createTime,1):"--",replayDate:-1!=a.replayDate?Object(d.a)(a.replayDate,1):"--"}),t.evaluateData=a.scoresList.map(function(e){return s()({},e,{evaluateScore:e.evaluateScore/2})})):t.evaluateData=[],console.log()}else Object(n.a)(e.data.message)}).catch(function(e){Object(n.b)(e)})},handleSearch:function(){this.page.currentPage=1,this.getMemberOrderPage()},handleCurrentChange:function(e){this.page.currentPage=e,this.getMemberOrderPage()},handleSizeChange:function(e){this.page.pageSize=e,this.getMemberOrderPage()},getMemberOrderPage:function(){var e=this;Object(l.a)(i.a.memberOrderPage,{memberId:this.memberId,pageSize:this.page.pageSize,currentPage:this.page.currentPage,orderType:this.orderType,evaluateStatus:this.evaluateStatus,searchInfo:this.searchInfo}).then(function(t){e.memberData=[],e.load=!0,0===t.data.errorCode?(e.load=!1,e.memberData=t.data.result.page.result.map(function(e){return s()({},e,{receiptsDate:-1!=e.receiptsDate?Object(d.a)(e.receiptsDate,1):"",orderTime:-1!=e.orderTime?Object(d.a)(e.orderTime,1):""})}),e.page.currentPage=t.data.result.page.currentPage,e.page.totalCount=t.data.result.page.totalCount):Object(n.a)(t.data.message)}).catch(function(e){Object(n.b)(e)})},getAjaxMembersInfo:function(){var e=this;Object(l.a)(i.a.ajaxMembersInfo,{memberId:this.memberId}).then(function(t){if(0===t.data.errorCode){var a=t.data.result.memberInfo;e.memberInfo={costFee:a.costFee,costTimes:a.costTimes,lastCostTime:a.lastCostTime,avgCost:a.avgCost,relatedPercent:a.relatedPercent,avgGoodsCost:a.avgGoodsCost,highCost:a.highCost,costCategoryCount:a.costCategoryCount,avgDiscount:a.avgDiscount,costFeePaid:a.costFeePaid,highCostPaid:a.highCostPaid}}else Object(n.a)(t.data.message)}).catch(function(e){Object(n.b)(e)})},goback:function(){this.$router.push({path:"wechatmemberDetail",query:{memberId:this.memberId}})},replayFast:function(){this.replayVisable=!0},confirmReplay:function(){var e=this;this.textarea&&Object(l.a)("/api-member/evalaute_recover",{evaluateId:this.evaluateId,replyContent:this.textarea}).then(function(t){0===t.data.errorCode&&(e.getOrderDetail(e.orderId),e.replayVisable=!1)})}},created:function(){this.memberId&&(this.getAjaxMembersInfo(),this.getMemberOrderPage()),this.$store.commit("mutations-slide",!1)},components:{"v-nav":o.a,searchinput:c.a}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"minwidth1200 member-fee"},[a("div",{staticClass:"con-container"},[a("v-nav",{attrs:{navpath:e.navpath}}),e._v(" "),a("div",{staticClass:"record-nav"},[a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("消费总额(实付)")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v("￥"+e._s(e._f("fomatFloat")(e.memberInfo.costFeePaid)))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("消费总额(应收)")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v(e._s(e._f("fomatFloat")(e.memberInfo.costFee)))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("消费次数")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v(e._s(e.memberInfo.costTimes))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("最近消费")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v(e._s(e._f("formatYMD")(e.memberInfo.lastCostTime)))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("客单价")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v("￥"+e._s(e._f("fomatFloat")(e.memberInfo.avgCost)))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("连带率")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v(e._s(e._f("fomatFloat")(e.memberInfo.relatedPercent)))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("件单价")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v("￥"+e._s(e._f("fomatFloat")(e.memberInfo.avgGoodsCost)))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("最高单笔(实付)")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v(e._s(e._f("fomatFloat")(e.memberInfo.highCostPaid)))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("最高单笔(应收)")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v(e._s(e._f("fomatFloat")(e.memberInfo.highCost)))])]),e._v(" "),a("div",{staticClass:"record-navitem"},[a("p",{staticClass:"lheigth40"},[e._v("平均折扣")]),e._v(" "),a("p",{staticClass:"record-txt"},[e._v(e._s(e._f("fomatFloat")(e.memberInfo.avgDiscount)))])])]),e._v(" "),a("div",{staticClass:"record"},[a("div",{staticClass:"mTop20"},[a("div",{staticClass:"record-search mBottom20"},[a("div",{staticClass:"record-searchitem"},[a("el-select",{attrs:{placeholder:"所有类型"},on:{change:e.handleSearch},model:{value:e.orderType,callback:function(t){e.orderType=t},expression:"orderType"}},[a("el-option",{key:-1,attrs:{label:"所有类型",value:-1}}),e._v(" "),a("el-option",{key:1,attrs:{label:"销售",value:1}}),e._v(" "),a("el-option",{key:2,attrs:{label:"退货",value:2}}),e._v(" "),a("el-option",{key:4,attrs:{label:"退换货",value:4}})],1),e._v(" "),a("el-select",{attrs:{placeholder:"所有状态"},on:{change:e.handleSearch},model:{value:e.evaluateStatus,callback:function(t){e.evaluateStatus=t},expression:"evaluateStatus"}},[a("el-option",{key:-1,attrs:{label:"所有状态",value:-1}}),e._v(" "),a("el-option",{key:0,attrs:{label:"未评价",value:0}}),e._v(" "),a("el-option",{key:1,attrs:{label:"已评价",value:1}}),e._v(" "),a("el-option",{key:2,attrs:{label:"不良评价",value:2}})],1)],1)]),e._v(" "),a("div",{staticClass:"mBottom40"},[a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"}],ref:"multipleTable",attrs:{data:e.memberData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"putOnTime",label:"操作时间",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  "+e._s(t.row.orderTime)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"orderNumber",label:"单据流水号",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.orderNumber))]),e._v(" "),a("div",[e._v(e._s(t.row.receiptsDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"storeName",label:"消费门店"}}),e._v(" "),a("el-table-column",{attrs:{prop:"clerkImageUrl",label:"导购信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"top-start",width:"400",height:"180",trigger:"hover"}},[a("div",{staticClass:"record-clerkpopover"},[a("div",{staticClass:"record-popoverimg"},[a("img",{attrs:{width:"150",height:"150",src:t.row.clerkImageUrl?t.row.clerkImageUrl:"./static/img/default.png",alt:""}})]),e._v(" "),a("div",{staticClass:"record-content"},[a("p",{staticStyle:{color:"#fff"}},[e._v("s")]),e._v(" "),a("p",[a("span",{staticClass:"record-infodetail"},[e._v("姓名")]),a("span",[e._v(e._s(t.row.clerkName))])]),e._v(" "),a("p",[a("span",{staticClass:"record-infodetail"},[e._v("员工代码")]),a("span",[e._v(e._s(t.row.clerkCode))])]),e._v(" "),a("p",[a("span",{staticClass:"record-infodetail"},[e._v("职位")]),a("span",[e._v(e._s(t.row.positionName))])]),e._v(" "),a("p",[a("span",{staticClass:"record-infodetail"},[e._v("所属门店")]),a("span",[e._v(e._s(t.row.storeName))])])])]),e._v(" "),a("div",{staticClass:"record-clerk",attrs:{slot:"reference"},slot:"reference"},[a("span",{staticClass:"record-clerkimg"},[a("img",{staticStyle:{"vertical-align":"middle"},attrs:{width:"60",height:"60",src:t.row.clerkImageUrl?t.row.clerkImageUrl:"./static/img/default.png",alt:""}})]),e._v(" "),a("span",{staticClass:"record-clerkname"},[e._v(e._s(t.row.clerkName)),a("br"),e._v(e._s(t.row.clerkCode))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"orderStatus",label:"订单类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.orderStatus?a("span",[e._v("销售")]):e._e(),e._v(" "),2===t.row.orderStatus?a("span",[e._v("退货")]):e._e(),e._v(" "),4===t.row.orderStatus?a("span",[e._v("退换货")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"paidAmount",label:"成交金额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"evaluateStatus",label:"评价状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.evaluateStatus?a("span",[e._v("未评价")]):e._e(),e._v(" "),1===t.row.evaluateStatus?a("span",[e._v("已评价")]):e._e(),e._v(" "),2===t.row.evaluateStatus?a("span",[e._v("不良评价")]):e._e(),e._v(" "),3===t.row.evaluateStatus?a("span",[e._v("未评价-已过期")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"operate"},[a("span",{staticClass:"pointer",on:{click:function(a){return e.getOrderDetail(t.row.orderId)}}},[e._v("查看详情")])])]}}])})],1),e._v(" "),e.page.totalCount>0?a("div",{staticClass:"page mTop20"},[a("el-pagination",{attrs:{background:"","current-page":e.page.currentPage,"page-sizes":[20,40,60,80],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next",total:e.page.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)])])])],1),e._v(" "),a("el-dialog",{attrs:{title:"订单详情",visible:e.dilogOrderVisible,width:"600px"},on:{"update:visible":function(t){e.dilogOrderVisible=t}}},[a("div",{staticClass:"record-dilog",staticStyle:{width:"560px"}},[a("div",{staticClass:"table-content"},[a("el-table",{ref:"orderTable",attrs:{data:e.orderData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"productName",label:"商品信息",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"record-info"},[a("div",{staticClass:"record-infoimg"},[a("img",{attrs:{width:"60",height:"60",src:t.row.thirdImgUrl?t.row.thirdImgUrl:"./static/img/default.png",alt:""}})]),e._v(" "),a("div",{staticClass:"record-infocontent"},[a("div",[e._v(e._s(t.row.productName))]),e._v(" "),a("div",[e._v(e._s(t.row.productCode))]),e._v(" "),a("div",{staticStyle:{color:"#c0c4cc"}},e._l(t.row.attrColorSize,function(t,r){return a("span",{key:r},[e._v("\n                      "+e._s(t.key)+":"+e._s(t.value)+"\n                    ")])}),0),e._v(" "),a("div")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"number",label:"数量",width:"120px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"payPrice",label:"成交价"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.unitPrice))]),e._v(" "),a("p",[e._v(e._s(t.row.payPrice))])]}}])})],1),e._v(" "),a("div",{staticClass:"record-border"},[a("div",{staticClass:"record-countwrap"},[a("p",[a("span",{staticClass:"record-count"},[e._v("商品总价")]),a("span",{staticClass:"record-countvalue"},[e._v(e._s(e.orderInfo.totalAmount))])]),e._v(" "),a("p",[a("span",{staticClass:"record-count"},[e._v("优惠活动")]),a("span",{staticClass:"record-countvalue"},[e._v(e._s(e.orderInfo.promotionAmount))])]),e._v(" "),a("p",[a("span",{staticClass:"record-count"},[e._v("应付金额")]),a("span",{staticClass:"record-countvalue"},[e._v(e._s(e.orderInfo.paidAmount))])])])]),e._v(" "),a("div",{staticClass:"record-border"},[a("div",{staticClass:"record-countwrap"},e._l(e.payInfo,function(t,r){return a("p",{key:r},[a("span",{staticClass:"record-count"},[e._v(e._s(t.name))]),a("span",{staticClass:"record-countvalue"},[e._v(e._s(t.value))])])}),0)]),e._v(" "),a("div",{staticClass:"record-border"},[a("div",{staticClass:"record-countwrap"},[a("p",[a("span",{staticClass:"record-count"},[e._v("订单总额")]),a("span",{staticClass:"record-countvalue"},[e._v(e._s(e.orderInfo.paidAmount))])])])])],1),e._v(" "),e.evaluateData.length?a("div",{staticClass:"evaluate-box"},[a("div",{staticClass:"evaluate-con"},e._l(e.evaluateData,function(t,r){return a("div",{key:r,staticClass:"item"},[e._v("\n            "+e._s(t.ruleName)+"\n            "),a("div",{staticClass:"evaluate-star"},[a("el-rate",{attrs:{disabled:"",colors:["#99A9BF","#F7BA2A","#FF9900"]},model:{value:t.evaluateScore,callback:function(a){e.$set(t,"evaluateScore",a)},expression:"item.evaluateScore"}})],1)])}),0),e._v(" "),a("div",{staticClass:"e-txt"},[a("div",{staticClass:"e-con"},[a("p",[e._v("买家评语")]),e._v(" "),a("p",[e._v(e._s(e.evaluate.evaluateContent))])]),e._v(" "),a("span",{staticClass:"e-time"},[e._v("\n            "+e._s(e.evaluate.createTime)+"\n          ")])]),e._v(" "),e.evaluate.replyContent?a("div",{staticClass:"r-txt"},[a("div",{staticClass:"e-con"},[a("p",[e._v("商家回复")]),e._v(" "),a("p",[e._v(e._s(e.evaluate.replyContent))])]),e._v(" "),a("span",{staticClass:"e-time"},[e._v("\n            "+e._s(e.evaluate.replayDate)+"\n          ")])]):e._e(),e._v(" "),e.evaluate.replyContent?e._e():a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{on:{click:e.replayFast}},[e._v("立即回复")])],1)]):e._e()]),e._v(" "),a("div",{staticClass:"dilog-footer talign",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dilogOrderVisible=!1}}},[e._v("关闭")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"回复",visible:e.replayVisable,width:"30%"},on:{"update:visible":function(t){e.replayVisable=t}}},[a("div",{},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入回复内容"},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}})],1),e._v(" "),a("span",{staticClass:"dilog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.replayVisable=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmReplay}},[e._v("确 定")])],1)]),e._v(" "),a("div",{staticClass:"footer-box"},[a("vue-gic-footer")],1)],1)},staticRenderFns:[]};var p=a("VU/8")(v,u,!1,function(e){a("616v")},null,null);t.default=p.exports}});